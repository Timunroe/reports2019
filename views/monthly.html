<%
import re

def humanize(value, fraction_point=1):
    if value != '':
        if value == 0:
            return '0'
        end
        powers = [10 ** x for x in (12, 9, 6, 3, 0)]
        human_powers = ('T', 'B', 'M', 'K', '')
        is_negative = False
        if not isinstance(value, float):
            value = float(value)
        end
        if value < 0:
            is_negative = True
            value = abs(value)
        end
        for i, p in enumerate(powers):
            if value >= p:
                return_value = str(round(value / (p / (10.0 ** fraction_point)))
                                   / (10 ** fraction_point)) + human_powers[i]
                break
            end
        end
        if is_negative:
            return_value = "-" + return_value
        end
        # remove pesky situation where xXX.0 occurs
        # return_value = return_value.replace('.0', '')
        # print("Return value is: ", return_value)
        return_value = re.sub(r'.0$', '', return_value)
        return return_value.replace('.0K', 'K')
    else:
        return '0'
    end
end
%>

<html>
    <head>
        <meta charset="UTF-8">
        <style>
            html{font-family:sans-serif;line-height:1.15;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;-ms-overflow-style:scrollbar;-webkit-tap-highlight-color:transparent}article,aside,dialog,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif;font-size:1rem;font-weight:400;line-height:1.5;color:#212529;text-align:left;background-color:#fff}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:16px;}p{margin-top:0;margin-bottom:16px;}dl,ol,ul{margin-top:0;margin-bottom:14px;}li{margin-bottom:16px;}table{display:table;border-collapse:collapse;border-spacing:0;width:100%;}th{text-align: inherit;}p{}
        </style>
    </head>
    <body>
        <h2>{{freq.title()}} report {{name.title()}}</h2>
        <p>PATH TO REGISTRATION: Last 3 clicks in 7 days</p>
        <p>MOST READ BY REGISTERED USERS (page views)</p>
        % include('kpi.html', site=site)
        <hr />
        % include('site_highlights.html', site=site)
        <hr />
        % include('top_articles.html', articles=articles)
        <hr />
        % include('home_page.html', hp=hp)
        <hr />
        % include('top_referrers.html', data=top_referrers)
        <hr />
        % include('long_reads.html', data=long_reads)
        <hr />
        <h3 style="font-size: 16px;">TRAFFIC PRIMER</h3>
        <p>Traffic is described by 5 categories: 4 external (social, search, direct, other) and internal.</p>
        <ul>
        <li>
        <p><strong>Internal</strong>: Usually from home page to article, though also from article to article via related links, most read etc.</p>
        </li>
        <li>
        <p><strong>Search</strong>: Google overwhelmingly, though also Bing, Yahoo, DuckDuckGo.</p>
        </li>
        <li>
        <p><strong>Social</strong>: Networks such as Facebook, Twitter, Pinterest, LinkedIn, Reddit etc. Users supply most of the links.</p>
        </li>
        <li>
        <p><strong>Direct</strong>: We don’t know how users got there because the source doesn’t provide the information.<br />
        If talking about <em>site</em> traffic, it mostly means people who type ‘thespec.com’ in the browser or have bookmarked the site. <br />
        If talking about <em>article</em> traffic, the user likely didn't type in the full URL, but came from a newsletter email, texting app or some other app such as Reddit's or Facebook Messenger.<br />
        </p>
        </li>
        <li><strong>Other</strong>: Curation services such as Google News, Apple News, Flipboard, SmartNews etc.</li>
        </ul>
    </body>
    
</html>


<table>
    <thead>
        <tr>
            <th></th>
            <th></th>
            <th></th>
            <th></th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
        </tr>
        <tr>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
    </tbody>
</table>